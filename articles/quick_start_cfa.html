<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Start To set_cfa_layout • semptools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start To set_cfa_layout">
<meta property="og:description" content="semptools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semptools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/semptools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/keep_or_drop_nodes.html">Keep or Drop Selected Variables</a>
    </li>
    <li>
      <a href="../articles/layout_matrix.html">Layout Matrices</a>
    </li>
    <li>
      <a href="../articles/quick_start_cfa.html">Quick Start To set_cfa_layout</a>
    </li>
    <li>
      <a href="../articles/quick_start_sem.html">Quick Start To set_sem_layout</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sfcheung/semptools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quick_start_cfa_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick Start To set_cfa_layout</h1>
                        <h4 class="author">Shu Fai Cheung &amp; Mark Hok Chio Lai</h4>
            
            <h4 class="date">2021-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/semptools/blob/master/vignettes/quick_start_cfa.Rmd"><code>vignettes/quick_start_cfa.Rmd</code></a></small>
      <div class="hidden name"><code>quick_start_cfa.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>semptools</code> package contains functions that <em>post-process</em> an output from <code><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPlot::semPaths()</a></code>, to help users to customize the appearance of the graphs generated by <code><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPlot::semPaths()</a></code>. For the introduction to functions for doing very specific tasks, such as moving the parameter estimate of a path or rotating the residual of a variable, please refer to <code><a href="../articles/semptools.html">vignette("semptools")</a></code>. The present guide focuses on how to use <code><a href="../reference/set_cfa_layout.html">set_cfa_layout()</a></code> to configure various aspects of an <code>semPaths</code> graph generated for a typical confirmatory factor analysis (CFA) model.</p>
</div>
<div id="the-initial-sempaths-graph" class="section level1">
<h1 class="hasAnchor">
<a href="#the-initial-sempaths-graph" class="anchor"></a>The Initial semPaths Graph</h1>
<p>Let us consider a CFA model. We will use <code>cfa_example</code>, a sample CFA dataset from <code>semptools</code> with 14 variables for illustration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/semptools/">semptools</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cfa_example</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;      x01    x02    x03    x04    x05    x06    x07   x08   x09    x10    x11</span>
<span class="co">#&gt; 1  1.159  1.271  1.451 -0.691 -0.015 -0.212 -0.336 1.559 0.870  1.115 -1.251</span>
<span class="co">#&gt; 2  0.059 -0.496 -0.585 -1.800 -0.555  0.012  1.208 0.551 0.055 -0.365 -0.142</span>
<span class="co">#&gt; 3 -0.737  2.933  1.625  0.642 -1.218 -0.155 -0.861 0.862 0.738  2.443 -0.628</span>
<span class="co">#&gt;     x12    x13    x14</span>
<span class="co">#&gt; 1 0.253  0.663 -1.049</span>
<span class="co">#&gt; 2 0.110 -0.207 -0.226</span>
<span class="co">#&gt; 3 1.604 -1.688  0.395</span></code></pre></div>
<p>This is the CFA model to be fitted:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> 
  <span class="st">'f1 =~ x01 + x02 + x03
   f2 =~ x04 + x05 + x06 + x07
   f3 =~ x08 + x09 + x10
   f4 =~ x11 + x12 + x13 + x14
  '</span></code></pre></div>
<p>Fitting the model by <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">lavaan::cfa()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>
<span class="co">#&gt; This is lavaan 0.6-9</span>
<span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">cfa_example</span><span class="op">)</span></code></pre></div>
<p>This is the plot from <code><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPlot::semPaths()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SachaEpskamp/semPlot">semPlot</a></span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPaths</a></span><span class="op">(</span><span class="va">fit</span>, whatLabels<span class="op">=</span><span class="st">"est"</span>,
        sizeMan <span class="op">=</span> <span class="fl">3.25</span>,
        node.width <span class="op">=</span> <span class="fl">1</span>,
        edge.label.cex <span class="op">=</span> <span class="fl">.75</span>,
        style <span class="op">=</span> <span class="st">"ram"</span>,
        mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The default layout is sufficient to have a quick examination of the results. We will see how <code><a href="../reference/set_cfa_layout.html">set_cfa_layout()</a></code> can be used to do the following tasks to <em>post-process</em> the graph:</p>
<ul>
<li><p>Change the order of the indicators.</p></li>
<li><p>Change the order of the factors.</p></li>
<li><p>Change the curvature of the inter-factor covariances.</p></li>
<li><p>Move the loadings along the paths from factors to indicators.</p></li>
<li><p>Rotate the graph.</p></li>
</ul>
</div>
<div id="order-the-indicators-and-factors" class="section level1">
<h1 class="hasAnchor">
<a href="#order-the-indicators-and-factors" class="anchor"></a>Order the Indicators and Factors</h1>
<p>Suppose we want to do this:</p>
<ul>
<li>
<p>Order the factors this way, from the left to the right:</p>
<ul>
<li><code>f2, f1, f4, f3</code></li>
</ul>
</li>
<li>
<p>Order the indicators this way, from the left to the right:</p>
<ul>
<li><code>x04, x05, x06, x07, x01, x02, x03, x11, x12, x13, x14, x08, x09, x10</code></li>
</ul>
</li>
<li>
<p>We would like to place the factors this way:</p>
<ul>
<li><p><code>f2</code> above the center of <code>x04</code>, <code>x05</code>, <code>x06</code>, and <code>x07</code>.</p></li>
<li><p><code>f1</code> above the center of <code>x01</code>, <code>x02</code>, and <code>x03</code>.</p></li>
<li><p><code>f4</code> above the center of <code>x11</code>, <code>x12</code>, <code>x13</code>, and <code>x14</code>.</p></li>
<li><p><code>f3</code> above the center of <code>x08</code>, <code>x09</code>, and <code>x10</code>.</p></li>
</ul>
</li>
</ul>
<p>To do this, we create two vectors, one for the argument <code>indicator_order</code> and the other for the argument <code>indicator_factor</code>.</p>
<ul>
<li>
<code>indicator_order</code> is a string vector with length equal to the number of indicators, with the desired order. In this example, it will be like this:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indicator_order</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x04"</span>, <span class="st">"x05"</span>, <span class="st">"x06"</span>, <span class="st">"x07"</span>, 
                      <span class="st">"x01"</span>, <span class="st">"x02"</span>, <span class="st">"x03"</span>, 
                      <span class="st">"x11"</span>, <span class="st">"x12"</span>, <span class="st">"x13"</span>, <span class="st">"x14"</span>,
                      <span class="st">"x08"</span>, <span class="st">"x09"</span>, <span class="st">"x10"</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<code>indicator_factor</code> is a string vector with length equal to the number of indicators. The elements are the names of the latent factors, denoting which indicators will be used to compute the mean positions to place the latent factors:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indicator_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"f2"</span>,  <span class="st">"f2"</span>,  <span class="st">"f2"</span>,  <span class="st">"f2"</span>,  
                       <span class="st">"f1"</span>,  <span class="st">"f1"</span>,  <span class="st">"f1"</span>,  
                       <span class="st">"f4"</span>,  <span class="st">"f4"</span>,  <span class="st">"f4"</span>,  <span class="st">"f4"</span>,  
                       <span class="st">"f3"</span>,  <span class="st">"f3"</span>,  <span class="st">"f3"</span><span class="op">)</span></code></pre></div>
<p>The <code><a href="../reference/set_cfa_layout.html">set_cfa_layout()</a></code> function needs at least three arguments:</p>
<ul>
<li><p><code>semPaths_plot</code>: The <code>semPaths</code> plot.</p></li>
<li><p><code>indicator_order</code>: The vector for the order of indicators.</p></li>
<li><p><code>indicator_factor</code>: The vector for the placement of the latent factors.</p></li>
</ul>
<p>They do not have to be named if they are in this order.</p>
<p>We now use <code><a href="../reference/set_cfa_layout.html">set_cfa_layout()</a></code> to post-process the graph:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cfa_layout.html">set_cfa_layout</a></span><span class="op">(</span><span class="va">p</span>,
                     <span class="va">indicator_order</span>,
                     <span class="va">indicator_factor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="change-the-curvatures-of-the-factor-covariances" class="section level1">
<h1 class="hasAnchor">
<a href="#change-the-curvatures-of-the-factor-covariances" class="anchor"></a>Change the Curvatures of the Factor Covariances</h1>
<p>The graph has the factors and indicators ordered as required. However, the inter-factor covariances are too close to the factors. To increases the curvatures of the covariances, we can use the argument <code>fcov_curve</code>. The default is .4. Let us increase it to 1.75.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cfa_layout.html">set_cfa_layout</a></span><span class="op">(</span><span class="va">p</span>, 
                     <span class="va">indicator_order</span>,
                     <span class="va">indicator_factor</span>,
                     fcov_curve <span class="op">=</span> <span class="fl">1.75</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The covariances are now more readable. The exact effect of the values vary from graph to graph. Therefore, trial and error is required to find a value suitable for a graph.</p>
</div>
<div id="move-the-loadings" class="section level1">
<h1 class="hasAnchor">
<a href="#move-the-loadings" class="anchor"></a>Move the Loadings</h1>
<p>We can also move all the factor loadings together using the argument <code>loading_position</code>. The default value is .5, at the middle of the paths. If we want to move the loadings closer to the indicators, we increase this number. If we want to move the loadings closer to the indicators, we decrease this number. In the following example, we move the loadings closer to the indicators, and increase the distance between them in the process.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cfa_layout.html">set_cfa_layout</a></span><span class="op">(</span><span class="va">p</span>,
                     <span class="va">indicator_order</span>,
                     <span class="va">indicator_factor</span>,
                     fcov_curve <span class="op">=</span> <span class="fl">1.75</span>,
                     loading_position <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The factor loadings are now easier to read, and also closer to the corresponding indicators.</p>
</div>
<div id="rotate-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#rotate-the-model" class="anchor"></a>Rotate the Model</h1>
<p>The default orientation is “pointing downwards”: latent factors on the top, pointing down to the indicators on the bottom. The orientation can be set to one of these four directions: down (default), left, up, and right. This is done by the argument <code>point_to</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cfa_layout.html">set_cfa_layout</a></span><span class="op">(</span><span class="va">p</span>,
                     <span class="va">indicator_order</span>,
                     <span class="va">indicator_factor</span>,
                     fcov_curve <span class="op">=</span> <span class="fl">1.75</span>,
                     loading_position <span class="op">=</span> <span class="fl">.8</span>,
                     point_to <span class="op">=</span> <span class="st">"up"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="pipe" class="section level1">
<h1 class="hasAnchor">
<a href="#pipe" class="anchor"></a>Pipe</h1>
<p>Like other functions in <code>semptools</code>, the <code><a href="../reference/set_cfa_layout.html">set_cfa_layout()</a></code> function can be chained with other functions using the pipe operator, <code>%&gt;%</code>, from the package <code>magrittr</code>, or the native pipe operator <code>|&gt;</code> available since R 4.1.x. Suppose we want to mark the significant test results for the free parameters using <code><a href="../reference/mark_sig.html">mark_sig()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If R version &gt;= 4.1.0</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cfa_layout.html">set_cfa_layout</a></span><span class="op">(</span><span class="va">p</span>,
                     <span class="va">indicator_order</span>,
                     <span class="va">indicator_factor</span>,
                     fcov_curve <span class="op">=</span> <span class="fl">1.75</span>,
                     loading_position <span class="op">=</span> <span class="fl">.9</span>,
                     point_to <span class="op">=</span> <span class="st">"up"</span><span class="op">)</span> |&gt;
      <span class="fu"><a href="../reference/mark_sig.html">mark_sig</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="quick_start_cfa_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="limitations" class="section level1">
<h1 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h1>
<ul>
<li>Currently, if a function needs the SEM output, only lavaan output is supported.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shu Fai Cheung, Mark Hok Chio Lai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
